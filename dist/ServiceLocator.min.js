/*! ServiceLocator - v0.1.0 - Author: Jaime Bueza <jbueza@gmail.com> License: Apache 2.0 2012-12-19 */
var Service=function(t,n,r){typeof r=="undefined"&&(r={});var i={method:r.method||function(){var e="get";return t.match(/^get/i)?e="get":t.match(/^add|del|update/i)&&(e="post"),e}(),jsonp:!1,wrapped:!1,template:!1,contentType:"application/json; charset=utf-8"};this.name=t,this.uri=n,this.options=$.extend({},i,r)};Service.prototype.invoke=function(e,t,n){if(!t)return!1;var r=this,i,s=r.getOptions()||{},o=s.method,u=r.getURI(),a=s.responseType||"JSON";return s.template&&(uriObj=r.parse(u,e),u=uriObj.uri,o=="get"?e=null:e=uriObj.params),o=="post"&&s.contentType.match(/application\/json/gi)?i=JSON.stringify(e):i=e,$.ajax({url:u,data:i,dataTypeString:a,dataType:s.jsonp?"jsonp":a,type:o,async:s.async||!0,cache:s.cache||!1,contentType:s.contentType||"application/json; charset=utf-8"}).success(function(e){a=="JSON"&&this.contentType.match(/javascript/g)&&(e=$.parseJSON(e)),s.wrapped&&(e=r.unwrap(e));if("undefined"!=typeof t){var i=[null,e,arguments[1],arguments[2]];typeof t=="function"?t.apply(n,i):n[t].apply(n,i)}}).error(function(){"undefined"!=typeof t&&t.apply(n||this,arguments)})},Service.prototype.getName=function(){return this.name},Service.prototype.getURI=function(){return this.uri},Service.prototype.getOptions=function(){return this.options},Service.prototype.unwrap=function(e){var t=this,n={};for(var r in e)if(typeof r=="string"&&r.substr(r.length-6,r.length)=="Result"){e=t.convert(e[r]);break}return e},Service.prototype.convert=function(e){var t={};for(var n in e)t[n]=e[n];return t},Service.prototype.option=function(){if(!arguments.length)return!1;if(arguments.length>2)return!1;if("string"!=typeof arguments[0])return!1;if(arguments.length==2)return this.options[arguments[0]]=arguments[1],this;if(arguments.length==1)return this.options[arguments[0]]},Service.prototype.parse=function(e,t){if(arguments.length!=2)return!1;if("string"!=typeof e)return!1;if("object"!=typeof t)return!1;var n=[];$.each(t,function(t,r){e.split("{"+t+"}").length>1&&n.push(t),e=e.split("{"+t+"}").join(r)});for(var r=0;r<n.length;r++){var i=n[r];delete t[i]}return{uri:e,params:t}};var ServiceLocator={services:{},addService:function(e){return e?(this.services[e.name]=e,this):!1},getService:function(e){return this.services[e]},removeService:function(e){delete this.services[e]},removeServices:function(){return this.services={},!0},getServices:function(){return typeof this.services===undefined?!1:this.services}};